# Сервис организации задач

## Ключевые понятия

**Задача/тикет** - документ, описывающий какую-то проблему или ТЗ того что необходимо сделать. Содержит:
- Заголовок
- Описание
- Связи с другими тикетами (разных типов)
- Статус (текущий + история)
- Теги для поиска и дополнительные поля
- Автор тикета
- Кто ответственный (возможно несколько)
- Комментарии
- Прикрепленные файлы/изображения

**Доска** - страница с канбан-доской, содержащей тикеты на разных этапах выполнения.

**Проект** - группа задач и досок + общие настройки для них (возможные типы связей, возможные статусы, возможные теги и т.д.)

**Отчет** - документ, содержащий информацию о задачах завершенный в какой-то срок.

## Ключевые функциональные требования

- Создание/редактирование задач
- Real time комментарии с тредами
- Хранилище файлов и изображений для задач с кэшированием по хэшу.
- Поиск задач по тегам и тексту
- Просмотр доски, с сортировкой и фильтрами (в том числе сложными)
- Перемещение тикетов на доске (с real time обновлением для других участников)
- Кастомные статусы, типы связей и теги для каждого проекта
- Хранение истории всех изменений параметров тикетов
- Генерация HTML отчетов (возможно PDF)
- Уведомления по почте при подписке на задачи

## Ожидаемые объемы

- Предполагаем большое число проектов (≈1000), большое количество задач в каждом проекте (≈10000), но из которых активными в каждый момент является лишь небольшое число (≈50). 
- Число людей в каждом проекте может значительно отличаться, от ≈10 до ≈100.
- Задачи содержат обсуждения, поэтому возможно от ≈5 до ≈1000 комментариев на каждую, отправленных в течении нескольких часов.
- Задачи содержат от 1 до ≈20 связанных задач.
- ≈5 возможных статусов, но статусы могут меняться по несколько раз в день.
- ≈20 тегов, но теги чаще всего устанавливаются при создании задачи.

## Архитектура

СУБД:
- PostgreSQL (с возможным шардированием по проектам)
- Redis x2 (для кэширования активных задач и обсуждений)
- ElasticSearch (для поиска по тексту задач)
- Garage (S3 хранилище для файлов)

Сеть:
- Nginx (для роутинга внешних запросов, HTTPS)

Микросервисы
- frontend-service (обработка HTTP от пользователей, генерация HTML)
- tickets-service (задачи и все с ними связанное)
- projects-service (редактирование настроек проекта)
- comments-service (комментарии в реальном времени)
- boards-service (доски в реальном времени)
- reports-service (генерация отчетов)
- search-service (поиск задач)
- files-service (хранение файлов в S3)
- email-service (отправка email-уведомлений)

Все сервисы общаются между собой по gPRC, но frontend и files также имеют REST API, и frontend использует server side rendering через HTMX.

Аутентификация пока что не рассматривается и будет добавлена позднее.